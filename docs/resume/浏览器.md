## 跨域

因为浏览器出于安全考虑，有同源策略。也就说，如果协议、域名、或者端口有一个不同就是跨域，`ajax` 请求就会失败。

我们可以通过以下几种常用方法解决跨域的问题

#### JSONP

`JSONP` 的原理，利用 `<script>` 标签没有跨域限制的漏洞。通过 `<script>` 标签指向一个访问地址并提供一个回调函数来接收数据

#### CORS 跨域资源共享

`CORS` 需要浏览器和后端同时支持。`IE 8` 和 `IE 9` 需要通过 `XDomainRequest`来实现。
浏览器会自动进行 `CORS` 通信，实现 `CORS` 通信的关键是后端。只要后端实现了 `CORS`，就实现了跨域。
服务端设置 `Access-Control-Aollw-Origin` 就可以开启 `CORS`。该属性表示哪些域名可以访问资源，如果设置通配符则表示所有网站都可以访问资源。

#### 代理

`webpack` 配置 `proxy`，把服务代理到本地。


## 事件机制

#### 事件触发有三个阶段

1. `window` 往事件触发处传播，遇到注册的捕获事件会触发
2. 传播到事件触发处时触发注册的事件
3. 从事件触发处往 window 传播，遇到注册的冒泡事件会触发

```js
// 以下会先打印冒泡然后是捕获
node.addEventListener(
  'click',
  event => {
    console.log('1.冒泡')
  },
  false
)
node.addEventListener(
  'click',
  event => {
    console.log('2.捕获 ')
  },
  true
)
// -> 1.冒泡 2.捕获
```

#### 注册事件

```js
node.addEventListener(
  'click',
  event => {
    // stopImmediatePropagation 同样也能实现阻止事件，但是还能阻止该事件目标执行别的注册事件
    event.stopImmediatePropagation()
    console.log('1.冒泡')
  },
  false
)
// 点击 node 只会执行上面的函数，该函数不会执行
node.addEventListener(
  'click',
  event => {
    console.log('2.捕获 ')
  },
  true
)
// -> 1.冒泡
```

#### 事件代理

如果一个节点中的子节点是动态生成的，那么子节点需要注册事件的话应该注册在父节点上

```html
<ul id="ul">
  <li>1</li>
  <li>2</li>
  <li>3</li>
  <li>4</li>
  <li>5</li>
</ul>
<script>
  let ul = document.querySelector('##ul')
  ul.addEventListener('click', event => {
    console.log(event.target)
  })
</script>
```

事件代理的方式相对于直接给目标注册事件来说，有以下优点

- 节省内存
- 不需要给子节点注销事件
